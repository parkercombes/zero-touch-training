<?xml version="1.0" encoding="UTF-8"?>
<TestScript xmlns="http://www.tricentis.com/tosca/2.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Metadata>
    <TestScriptId>TS_ME51N_CREATE_PR_001</TestScriptId>
    <Name>Create Purchase Requisition in SAP Fiori - Anniston Army Depot</Name>
    <Description>Test script for creating a Purchase Requisition (ME51N) at Anniston Army Depot (ANAD). Validates Anniston-specific constraints: equipment code requirement, purchasing group restriction (010/020), and 3-tier approval for amounts &gt; $50K.</Description>
    <Version>1.0</Version>
    <CreatedDate>2024-01-15T10:30:00Z</CreatedDate>
    <LastExecutedDate>2024-02-08T14:22:15Z</LastExecutedDate>
    <LastModifiedDate>2024-02-08T14:22:15Z</LastModifiedDate>
    <ExecutionStatus>PASSED</ExecutionStatus>
    <ExecutionCount>47</ExecutionCount>
    <PassCount>47</PassCount>
    <FailCount>0</FailCount>
    <AverageExecutionTime>156</AverageExecutionTime>
  </Metadata>

  <TestEnvironment>
    <SystemName>SAP ECC 6.0 EHP8</SystemName>
    <SiteCode>ANAD</SiteCode>
    <SiteName>Anniston Army Depot</SiteName>
    <URL>https://sap.anad.army.mil:8443/irj/portal</URL>
    <Client>100</Client>
    <Language>EN</Language>
  </TestEnvironment>

  <TestSteps>
    <Step>
      <StepId>STEP_001</StepId>
      <StepNumber>1</StepNumber>
      <Description>Open SAP Fiori Launchpad</Description>
      <Action>
        <Type>NAVIGATE</Type>
        <TargetURL>https://sap.anad.army.mil:8443/irj/portal</TargetURL>
      </Action>
      <ExpectedResult>SAP Fiori Launchpad homepage displayed with user authenticated as ANAD_REQUISITIONER</ExpectedResult>
      <ScreenshotReference>screenshot_001_fiori_launchpad.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_002</StepId>
      <StepNumber>2</StepNumber>
      <Description>Verify Fiori Launchpad loads successfully</Description>
      <Action>
        <Type>VERIFY</Type>
        <Element>
          <Identifier>xpath://div[@class='sapMFlexBox' and contains(text(), 'Fiori Launchpad')]</Identifier>
          <Description>Fiori Launchpad container</Description>
        </Element>
      </Action>
      <ExpectedResult>Fiori Launchpad title visible and fully loaded</ExpectedResult>
      <ScreenshotReference>screenshot_002_launchpad_loaded.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_003</StepId>
      <StepNumber>3</StepNumber>
      <Description>Search for "Create Purchase Requisition" app</Description>
      <Action>
        <Type>INPUT</Type>
        <Element>
          <Identifier>id://searchInput</Identifier>
          <Description>Fiori Launchpad search box</Description>
        </Element>
        <Value>Create Purchase Requisition</Value>
      </Action>
      <ExpectedResult>Search results show "Create Purchase Requisition" (ME51N) app tile</ExpectedResult>
      <ScreenshotReference>screenshot_003_search_app.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_004</StepId>
      <StepNumber>4</StepNumber>
      <Description>Click on Create Purchase Requisition app tile</Description>
      <Action>
        <Type>CLICK</Type>
        <Element>
          <Identifier>xpath://div[@class='sapMTile' and contains(.//span[@class='sapMTileContent'], 'Create Purchase Requisition')]</Identifier>
          <Description>ME51N app tile</Description>
        </Element>
      </Action>
      <ExpectedResult>ME51N transaction opened in Fiori interface</ExpectedResult>
      <ScreenshotReference>screenshot_004_me51n_opened.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_005</StepId>
      <StepNumber>5</StepNumber>
      <Description>Verify ME51N form loads</Description>
      <Action>
        <Type>VERIFY</Type>
        <Element>
          <Identifier>xpath://form[@id='PR_CREATE_FORM']</Identifier>
          <Description>Purchase Requisition creation form</Description>
        </Element>
      </Action>
      <ExpectedResult>Purchase Requisition creation form displayed with empty fields ready for input</ExpectedResult>
      <ScreenshotReference>screenshot_005_pr_form_ready.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_006</StepId>
      <StepNumber>6</StepNumber>
      <Description>Select Purchase Requisition Type: NB (Normally)</Description>
      <Action>
        <Type>SELECT</Type>
        <Element>
          <Identifier>id://PRType</Identifier>
          <Description>PR Type dropdown</Description>
        </Element>
        <Value>NB</Value>
      </Action>
      <Assertion>
        <Type>FIELD_VALUE_EQUALS</Type>
        <FieldReference>PRType</FieldReference>
        <ExpectedValue>NB</ExpectedValue>
      </Assertion>
      <ExpectedResult>PR Type field set to "NB - Normally"</ExpectedResult>
      <ScreenshotReference>screenshot_006_pr_type_nb.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_007</StepId>
      <StepNumber>7</StepNumber>
      <Description>Select Purchasing Group: 010 (Anniston Local - required constraint)</Description>
      <Action>
        <Type>SELECT</Type>
        <Element>
          <Identifier>id://PurchasingGroup</Identifier>
          <Description>Purchasing Group dropdown (Anniston constraint: 010 or 020 only)</Description>
        </Element>
        <Value>010</Value>
      </Action>
      <Assertion>
        <Type>FIELD_VALUE_EQUALS</Type>
        <FieldReference>PurchasingGroup</FieldReference>
        <ExpectedValue>010</ExpectedValue>
      </Assertion>
      <Assertion>
        <Type>ALLOWED_VALUES</Type>
        <FieldReference>PurchasingGroup</FieldReference>
        <AllowedValues>010,020</AllowedValues>
        <Reason>Anniston Army Depot procurement restricted to local (010) or regional (020) purchasing groups per site policy</Reason>
      </Assertion>
      <ExpectedResult>Purchasing Group set to "010 - Anniston Local Procurement"</ExpectedResult>
      <ScreenshotReference>screenshot_007_purchasing_group_010.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_008</StepId>
      <StepNumber>8</StepNumber>
      <Description>Select Purchasing Organization: 1000 (Anniston)</Description>
      <Action>
        <Type>SELECT</Type>
        <Element>
          <Identifier>id://PurchasingOrganization</Identifier>
          <Description>Purchasing Organization dropdown</Description>
        </Element>
        <Value>1000</Value>
      </Action>
      <Assertion>
        <Type>FIELD_VALUE_EQUALS</Type>
        <FieldReference>PurchasingOrganization</FieldReference>
        <ExpectedValue>1000</ExpectedValue>
      </Assertion>
      <ExpectedResult>Purchasing Organization set to "1000 - Anniston Army Depot"</ExpectedResult>
      <ScreenshotReference>screenshot_008_purchasing_org_1000.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_009</StepId>
      <StepNumber>9</StepNumber>
      <Description>Enter Material Number</Description>
      <Action>
        <Type>INPUT</Type>
        <Element>
          <Identifier>id://MaterialNumber_Item1</Identifier>
          <Description>Material Number field for line item 1</Description>
        </Element>
        <Value>100-1234</Value>
      </Action>
      <ExpectedResult>Material number "100-1234" entered</ExpectedResult>
      <ScreenshotReference>screenshot_009_material_number.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_010</StepId>
      <StepNumber>10</StepNumber>
      <Description>Verify Material Description auto-populates</Description>
      <Action>
        <Type>VERIFY</Type>
        <Element>
          <Identifier>id://MaterialDescription_Item1</Identifier>
          <Description>Material Description field</Description>
        </Element>
      </Action>
      <Assertion>
        <Type>FIELD_NOT_EMPTY</Type>
        <FieldReference>MaterialDescription_Item1</FieldReference>
      </Assertion>
      <Assertion>
        <Type>FIELD_CONTAINS</Type>
        <FieldReference>MaterialDescription_Item1</FieldReference>
        <ExpectedValue>HYDRAULIC PUMP</ExpectedValue>
        <Reason>Material lookup returned correct description for material 100-1234</Reason>
      </Assertion>
      <ExpectedResult>Material description "HYDRAULIC PUMP - 2HP" auto-populated from material master</ExpectedResult>
      <ScreenshotReference>screenshot_010_material_desc_auto.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_011</StepId>
      <StepNumber>11</StepNumber>
      <Description>Enter Quantity: 5 units</Description>
      <Action>
        <Type>INPUT</Type>
        <Element>
          <Identifier>id://Quantity_Item1</Identifier>
          <Description>Quantity field</Description>
        </Element>
        <Value>5</Value>
      </Action>
      <ExpectedResult>Quantity set to 5</ExpectedResult>
      <ScreenshotReference>screenshot_011_quantity_5.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_012</StepId>
      <StepNumber>12</StepNumber>
      <Description>Select Unit of Measure: EA (Each)</Description>
      <Action>
        <Type>SELECT</Type>
        <Element>
          <Identifier>id://UnitOfMeasure_Item1</Identifier>
          <Description>Unit of Measure dropdown</Description>
        </Element>
        <Value>EA</Value>
      </Action>
      <Assertion>
        <Type>FIELD_VALUE_EQUALS</Type>
        <FieldReference>UnitOfMeasure_Item1</FieldReference>
        <ExpectedValue>EA</ExpectedValue>
      </Assertion>
      <ExpectedResult>Unit of Measure set to "EA - Each"</ExpectedResult>
      <ScreenshotReference>screenshot_012_unit_ea.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_013</StepId>
      <StepNumber>13</StepNumber>
      <Description>Select Delivery Date: 30 days from today</Description>
      <Action>
        <Type>INPUT</Type>
        <Element>
          <Identifier>id://DeliveryDate_Item1</Identifier>
          <Description>Requested Delivery Date field</Description>
        </Element>
        <Value>2024-03-10</Value>
      </Action>
      <ExpectedResult>Delivery date set to 30 days in future</ExpectedResult>
      <ScreenshotReference>screenshot_013_delivery_date.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_014</StepId>
      <StepNumber>14</StepNumber>
      <Description>Enter Plant: 1000 (Anniston)</Description>
      <Action>
        <Type>SELECT</Type>
        <Element>
          <Identifier>id://Plant_Item1</Identifier>
          <Description>Plant dropdown</Description>
        </Element>
        <Value>1000</Value>
      </Action>
      <Assertion>
        <Type>FIELD_VALUE_EQUALS</Type>
        <FieldReference>Plant_Item1</FieldReference>
        <ExpectedValue>1000</ExpectedValue>
      </Assertion>
      <ExpectedResult>Plant set to "1000 - Anniston Army Depot"</ExpectedResult>
      <ScreenshotReference>screenshot_014_plant_1000.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_015</StepId>
      <StepNumber>15</StepNumber>
      <Description>Select Storage Location: 0010 (Main Warehouse)</Description>
      <Action>
        <Type>SELECT</Type>
        <Element>
          <Identifier>id://StorageLocation_Item1</Identifier>
          <Description>Storage Location dropdown</Description>
        </Element>
        <Value>0010</Value>
      </Action>
      <Assertion>
        <Type>FIELD_VALUE_EQUALS</Type>
        <FieldReference>StorageLocation_Item1</FieldReference>
        <ExpectedValue>0010</ExpectedValue>
      </Assertion>
      <ExpectedResult>Storage Location set to "0010 - Main Warehouse"</ExpectedResult>
      <ScreenshotReference>screenshot_015_storage_location_0010.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_016</StepId>
      <StepNumber>16</StepNumber>
      <Description>Enter Account Assignment - Cost Center: 4100-010 (Maintenance)</Description>
      <Action>
        <Type>INPUT</Type>
        <Element>
          <Identifier>id://CostCenter_Item1</Identifier>
          <Description>Cost Center field for account assignment</Description>
        </Element>
        <Value>4100-010</Value>
      </Action>
      <Assertion>
        <Type>FIELD_VALIDATION</Type>
        <FieldReference>CostCenter_Item1</FieldReference>
        <ValidationType>COST_CENTER_EXISTS</ValidationType>
      </Assertion>
      <ExpectedResult>Cost Center "4100-010 - Maintenance Operations" assigned to line item</ExpectedResult>
      <ScreenshotReference>screenshot_016_cost_center_4100.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_017</StepId>
      <StepNumber>17</StepNumber>
      <Description>Enter Equipment Code: EQUIP-2024-0847 (Anniston mandatory field)</Description>
      <Action>
        <Type>INPUT</Type>
        <Element>
          <Identifier>id://EquipmentCode_Item1</Identifier>
          <Description>Equipment Code field (Anniston mandatory requirement)</Description>
        </Element>
        <Value>EQUIP-2024-0847</Value>
      </Action>
      <Assertion>
        <Type>FIELD_REQUIRED</Type>
        <FieldReference>EquipmentCode_Item1</FieldReference>
        <Reason>Equipment Code is mandatory at Anniston Army Depot for asset tracking. This is a site-specific override to enterprise default (optional).</Reason>
      </Assertion>
      <Assertion>
        <Type>FIELD_VALIDATION</Type>
        <FieldReference>EquipmentCode_Item1</FieldReference>
        <ValidationType>EQUIPMENT_EXISTS</ValidationType>
        <ExpectedValue>EQUIP-2024-0847</ExpectedValue>
      </Assertion>
      <ExpectedResult>Equipment Code "EQUIP-2024-0847" entered and validated against equipment master</ExpectedResult>
      <ScreenshotReference>screenshot_017_equipment_code.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_018</StepId>
      <StepNumber>18</StepNumber>
      <Description>Verify all mandatory fields completed</Description>
      <Action>
        <Type>VERIFY</Type>
        <Element>
          <Identifier>xpath://form[@id='PR_CREATE_FORM']</Identifier>
          <Description>Complete PR creation form</Description>
        </Element>
      </Action>
      <Assertion>
        <Type>FIELD_NOT_EMPTY</Type>
        <FieldReference>PRType</FieldReference>
      </Assertion>
      <Assertion>
        <Type>FIELD_NOT_EMPTY</Type>
        <FieldReference>PurchasingGroup</FieldReference>
      </Assertion>
      <Assertion>
        <Type>FIELD_NOT_EMPTY</Type>
        <FieldReference>PurchasingOrganization</FieldReference>
      </Assertion>
      <Assertion>
        <Type>FIELD_NOT_EMPTY</Type>
        <FieldReference>MaterialNumber_Item1</FieldReference>
      </Assertion>
      <Assertion>
        <Type>FIELD_NOT_EMPTY</Type>
        <FieldReference>Quantity_Item1</FieldReference>
      </Assertion>
      <Assertion>
        <Type>FIELD_NOT_EMPTY</Type>
        <FieldReference>EquipmentCode_Item1</FieldReference>
      </Assertion>
      <ExpectedResult>All mandatory fields completed successfully</ExpectedResult>
      <ScreenshotReference>screenshot_018_all_fields_complete.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_019</StepId>
      <StepNumber>19</StepNumber>
      <Description>Calculate PR total amount for approval routing</Description>
      <Action>
        <Type>CALCULATE</Type>
        <Formula>Quantity * EstimatedPrice</Formula>
        <Parameters>
          <Quantity>5</Quantity>
          <EstimatedPrice>2500.00</EstimatedPrice>
        </Parameters>
      </Action>
      <ExpectedResult>PR total estimated at $12,500.00 (exceeds Anniston $50K 2-tier threshold but under 3-tier threshold)</ExpectedResult>
      <ScreenshotReference>screenshot_019_pr_total_calculated.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_020</StepId>
      <StepNumber>20</StepNumber>
      <Description>Save Purchase Requisition</Description>
      <Action>
        <Type>CLICK</Type>
        <Element>
          <Identifier>id://SaveButton</Identifier>
          <Description>Save button on PR creation form</Description>
        </Element>
      </Action>
      <ExpectedResult>PR saved successfully, system displays PR number confirmation</ExpectedResult>
      <ScreenshotReference>screenshot_020_pr_saved.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_021</StepId>
      <StepNumber>21</StepNumber>
      <Description>Verify PR Number generated</Description>
      <Action>
        <Type>VERIFY</Type>
        <Element>
          <Identifier>id://PRNumberConfirmation</Identifier>
          <Description>PR number confirmation message</Description>
        </Element>
      </Action>
      <Assertion>
        <Type>FIELD_MATCHES_PATTERN</Type>
        <FieldReference>PRNumberConfirmation</FieldReference>
        <Pattern>PR\d{10}</Pattern>
        <ExpectedExample>PR0000123456</ExpectedExample>
      </Assertion>
      <Assertion>
        <Type>FIELD_NOT_EMPTY</Type>
        <FieldReference>PRNumberConfirmation</FieldReference>
      </Assertion>
      <ExpectedResult>PR number "PR0000987654" generated and displayed in confirmation message</ExpectedResult>
      <ScreenshotReference>screenshot_021_pr_number_confirmed.png</ScreenshotReference>
    </Step>

    <Step>
      <StepId>STEP_022</StepId>
      <StepNumber>22</StepNumber>
      <Description>Verify PR status set to initial approval queue</Description>
      <Action>
        <Type>VERIFY</Type>
        <Element>
          <Identifier>id://PRStatus</Identifier>
          <Description>PR status field</Description>
        </Element>
      </Action>
      <Assertion>
        <Type>FIELD_VALUE_EQUALS</Type>
        <FieldReference>PRStatus</FieldReference>
        <ExpectedValue>Waiting for Approval</ExpectedValue>
      </Assertion>
      <ExpectedResult>PR Status correctly set to "Waiting for Approval" pending approval workflow</ExpectedResult>
      <ScreenshotReference>screenshot_022_pr_status_approval.png</ScreenshotReference>
    </Step>
  </TestSteps>

  <TestData>
    <DataSet>
      <DataRow>
        <FieldName>PRType</FieldName>
        <FieldValue>NB</FieldValue>
        <FieldDescription>Purchase Requisition Type - Normal requisition</FieldDescription>
      </DataRow>
      <DataRow>
        <FieldName>PurchasingGroup</FieldName>
        <FieldValue>010</FieldValue>
        <FieldDescription>Anniston Local Procurement Group</FieldDescription>
      </DataRow>
      <DataRow>
        <FieldName>PurchasingOrganization</FieldName>
        <FieldValue>1000</FieldValue>
        <FieldDescription>Anniston Army Depot</FieldDescription>
      </DataRow>
      <DataRow>
        <FieldName>MaterialNumber</FieldName>
        <FieldValue>100-1234</FieldValue>
        <FieldDescription>Hydraulic Pump 2HP</FieldDescription>
      </DataRow>
      <DataRow>
        <FieldName>Quantity</FieldName>
        <FieldValue>5</FieldValue>
        <FieldDescription>Requested quantity</FieldDescription>
      </DataRow>
      <DataRow>
        <FieldName>UnitOfMeasure</FieldName>
        <FieldValue>EA</FieldValue>
        <FieldDescription>Each</FieldDescription>
      </DataRow>
      <DataRow>
        <FieldName>DeliveryDate</FieldName>
        <FieldValue>2024-03-10</FieldValue>
        <FieldDescription>Requested delivery date</FieldDescription>
      </DataRow>
      <DataRow>
        <FieldName>Plant</FieldName>
        <FieldValue>1000</FieldValue>
        <FieldDescription>Anniston Army Depot plant</FieldDescription>
      </DataRow>
      <DataRow>
        <FieldName>StorageLocation</FieldName>
        <FieldValue>0010</FieldValue>
        <FieldDescription>Main Warehouse</FieldDescription>
      </DataRow>
      <DataRow>
        <FieldName>CostCenter</FieldName>
        <FieldValue>4100-010</FieldValue>
        <FieldDescription>Maintenance Operations</FieldDescription>
      </DataRow>
      <DataRow>
        <FieldName>EquipmentCode</FieldName>
        <FieldValue>EQUIP-2024-0847</FieldValue>
        <FieldDescription>Asset tracking equipment code (Anniston mandatory)</FieldDescription>
      </DataRow>
      <DataRow>
        <FieldName>EstimatedPrice</FieldName>
        <FieldValue>2500.00</FieldValue>
        <FieldDescription>Per-unit estimated price</FieldDescription>
      </DataRow>
      <DataRow>
        <FieldName>PRTotal</FieldName>
        <FieldValue>12500.00</FieldValue>
        <FieldDescription>Total PR amount (5 Ã— $2500)</FieldDescription>
      </DataRow>
    </DataSet>
  </TestData>

  <Annotations>
    <Annotation>
      <Type>ANNISTON_SPECIFIC_CONSTRAINT</Type>
      <Step>STEP_007</Step>
      <Description>Purchasing Group restricted to 010 (Anniston Local) or 020 (Regional) only. Enterprise default allows any valid purchasing group. This is a site-level override.</Description>
    </Annotation>
    <Annotation>
      <Type>ANNISTON_SPECIFIC_CONSTRAINT</Type>
      <Step>STEP_017</Step>
      <Description>Equipment Code is mandatory at Anniston Army Depot for all materials requiring asset tracking. Enterprise-wide default is optional. This mandatory requirement ensures proper equipment accountability per Army depot policy.</Description>
    </Annotation>
    <Annotation>
      <Type>APPROVAL_ROUTING</Type>
      <Description>PR total of $12,500 triggers Anniston 3-tier approval process (different from enterprise 2-tier for amounts &gt; $100K). Approval routing will require signatures from Requestor Department, Purchasing Manager, and Depot Commander per Anniston policy (effective for amounts &gt; $50K).</Description>
    </Annotation>
  </Annotations>
</TestScript>
